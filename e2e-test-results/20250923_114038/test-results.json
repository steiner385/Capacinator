
> capacinator@1.0.0 test:e2e
> playwright test --reporter=json

ğŸš€ Starting E2E global setup...
ğŸ—„ï¸ E2E database will be initialized by server...
â„¹ï¸ Development server already running on ports 3110/3120
   E2E tests will use the existing server and database.
   For isolated testing, stop the dev server first.
â³ Waiting for application to be ready...
âœ… Application is ready
ğŸ” Verifying test data...
âœ… API health check passed
âœ… /api/roles: 4 items
ğŸ” Handling initial profile selection...
ğŸ“‹ Profile selection modal detected
ğŸ¯ Starting profile selection...

ğŸ“ Attempt 1/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âš ï¸ Standard role="option": No visible options
ğŸ” Trying strategy: Radix collection items
âš ï¸ Radix collection items: No visible options
ğŸ” Trying strategy: Portal with role="option"
âš ï¸ Portal with role="option": No visible options
ğŸ” Trying strategy: Any SelectItem in portal
âš ï¸ Any SelectItem in portal: No visible options
ğŸ” Trying strategy: Direct SelectContent children
âš ï¸ Direct SelectContent children: No visible options
ğŸ¹ Trying keyboard navigation...
ğŸ“Š After keyboard activation: 0 options
DOM state: 0 portals, 0 popper wrappers
âŒ Attempt 1 failed: Error: No profile options found on attempt 1
    at selectProfile (file:///home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:508:15)
    at handleInitialProfileSelection (file:///home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:334:7)
    at globalSetup (file:///home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:70:5)
    at Object.setup (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/tasks.js:173:27)
    at taskLoop (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/taskRunner.js:62:11)
    at TaskRunner.runDeferCleanup (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/taskRunner.js:78:5)
    at TaskRunner.run (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/taskRunner.js:42:33)
    at runTasks (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/tasks.js:79:18)
    at runAllTestsWithConfig (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/runner/testRunner.js:392:18)
    at runTests (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/program.js:188:18)
    at i.<anonymous> (/home/tony/GitHub/Capacinator/node_modules/playwright/lib/program.js:64:7)
ğŸ”„ Retrying...

ğŸ“ Attempt 2/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âœ… Standard role="option": Found 24 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'E2E Over Utilized (E2E Developer)',
  'E2E Normal Utilized (E2E Designer)',
  'E2E Under Utilized (E2E Manager)',
  'E2E Zero Utilized (E2E QA Engineer)',
  'write-ops-Project-To-Edit-Owner',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'forms-Person-1',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'forms-Project-To-Edit-Owner',
  'write-ops-Project-To-Delete-Owner',
  'write-ops-Person-1',
  'write-ops-Project-To-Edit-Owner',
  'write-ops-Person-1',
  'write-ops-Project-Owner',
  'write-ops-User',
  'write-ops-Person-To-Update',
  'write-ops-Person-To-Update'
]
Selecting profile: "E2E Over Utilized (E2E Developer)"
âŒ Attempt 2 failed: locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator('[role="option"]:visible').first()

    at selectProfile (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:463:43)
    at handleInitialProfileSelection (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:334:7)
    at globalSetup (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:70:5) {
  name: 'TimeoutError'
}
ğŸ”„ Retrying...

ğŸ“ Attempt 3/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âœ… Standard role="option": Found 24 options
DOM state: 0 portals, 0 popper wrappers
Available profiles: []
Selecting profile: "undefined"
âŒ Attempt 3 failed: locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator('[role="option"]:visible').first()

    at selectProfile (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:463:43)
    at handleInitialProfileSelection (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:334:7)
    at globalSetup (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:70:5) {
  name: 'TimeoutError'
}
ğŸ”Œ All UI attempts failed, trying API fallback...
ğŸ”Œ Using API fallback for profile selection...
API fallback: Selecting E2E Over Utilized
âœ… Profile selected via API fallback
âœ… Profile selected and saved
ğŸ’¾ Current auth data: { hasCurrentUser: true, hasSelectedProfile: true }
ğŸ’¾ Authentication state saved to /home/tony/GitHub/Capacinator/test-results/e2e-auth.json
âœ… Saved state verification: Contains localStorage data
âœ… E2E global setup completed successfully
