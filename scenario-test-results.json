🚀 Starting E2E global setup...
🗄️ Initializing E2E database...
🧪 Initializing E2E test database...
🗑️ Removed existing E2E database file
🔧 Running E2E database migrations...
Creating baseline database schema...
✅ Baseline database schema created successfully
Fixing primary role foreign key constraint...
✅ Fixed primary role foreign key constraint
Creating missing database views...
✅ Created missing database views
Adding person_utilization_view and project_demands_view...
✅ Added person_utilization_view and project_demands_view
Fixing project_demands_view with correct join conditions...
✅ Fixed project_demands_view with correct join conditions
Fixing database views...
✅ Fixed database views
Adding project_health_view for gaps analysis...
✅ Added project_health_view for gaps analysis
Fixing project_health_view with correct health_status column...
✅ Fixed project_health_view with correct health_status column
Creating settings table...
✅ Created settings table with default import settings
🔧 Fixing assignments with null dates...
Found 0 phase-based assignments with null dates
Found 0 project-based assignments with null dates
Found 0 assignments still with null dates
✅ Assignment dates fixed
Improving project_demands_view with hour calculations...
✅ Improved project_demands_view with hour calculations and project type info
Fixing project_demands_view missing columns...
✅ Fixed project_demands_view with missing phase_id and renamed estimated_hours to demand_hours
Creating project_phase_dependencies table...
✅ Created project_phase_dependencies table with constraints and indexes
🔧 Fixing missing IDs in database records...
Found 0 assignments without IDs
Found 0 availability overrides without IDs
✅ Fixed missing IDs
Creating person_availability_view...
✅ Created person_availability_view
Fixing person_utilization_view to use scenario assignments...
✅ Fixed person_utilization_view to use scenario assignments
Fixing project_demands_view to use actual assignments...
✅ Fixed project_demands_view to use scenario assignments
🌱 Seeding E2E test data...
🌱 Seeding consolidated E2E test data...
Existing people before clear: 
People count after clear: 0
✅ Consolidated E2E test data seeded successfully
📊 Utilization scenarios created:
   - E2E Over Utilized: 120% (80% + 40%)
   - E2E Normal Utilized: 80%
   - E2E Under Utilized: 40%
   - E2E Zero Utilized: 0%
✅ E2E database initialized successfully
✅ E2E database initialized successfully
ℹ️ Development server already running on ports 3110/3120
   E2E tests will use the existing server and database.
   For isolated testing, stop the dev server first.
⏳ Waiting for application to be ready...
✅ Application is ready
🔍 Verifying test data...
✅ API health check passed
✅ /api/roles: 13 items
🔍 Handling initial profile selection...
📋 Profile selection modal detected
🎯 Starting profile selection...

📍 Attempt 1/3 to select profile...
Select trigger text: "Select your name..."
📂 Opening profile dropdown...
🔍 Trying strategy: Standard role="option"
✅ Standard role="option": Found 8 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'Alice Johnson (Project Manager)',
  'Bob Smith (Senior Developer)',
  'Charlie Brown (Business Analyst)',
  'Diana Prince (QA Engineer)',
  'Eve Davis (DevOps Engineer)',
  'Frank Miller (UX Designer)',
  'Grace Hopper (Product Manager)',
  'Henry Ford (Data Scientist)'
]
Selecting profile: "Alice Johnson (Project Manager)"
Select value after click: "Alice Johnson (Project Manager)"
👆 Clicking Continue button...
✅ Profile selected successfully
✅ Profile selected and saved
💾 Current auth data: { hasCurrentUser: true, hasSelectedProfile: true }
💾 Authentication state saved to /home/tony/GitHub/Capacinator/test-results/e2e-auth.json
✅ Saved state verification: Contains localStorage data
✅ E2E global setup completed successfully
