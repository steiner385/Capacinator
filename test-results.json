🚀 Starting E2E global setup...
🗄️ Initializing E2E database...
🧪 Initializing E2E test database...
🔧 Running E2E database migrations...
Creating baseline database schema...
✅ Baseline database schema created successfully
Fixing primary role foreign key constraint...
✅ Fixed primary role foreign key constraint
Creating missing database views...
✅ Created missing database views
Adding person_utilization_view and project_demands_view...
✅ Added person_utilization_view and project_demands_view
Fixing project_demands_view with correct join conditions...
✅ Fixed project_demands_view with correct join conditions
Fixing database views...
✅ Fixed database views
Adding project_health_view for gaps analysis...
✅ Added project_health_view for gaps analysis
Fixing project_health_view with correct health_status column...
✅ Fixed project_health_view with correct health_status column
Improving project_demands_view with hour calculations...
✅ Improved project_demands_view with hour calculations and project type info
Fixing project_demands_view missing columns...
✅ Fixed project_demands_view with missing phase_id and renamed estimated_hours to demand_hours
Creating project_phase_dependencies table...
✅ Created project_phase_dependencies table with constraints and indexes
🔧 Fixing missing IDs in database records...
Found 0 assignments without IDs
Found 0 availability overrides without IDs
✅ Fixed missing IDs
🌱 Seeding E2E test data...
🌱 Seeding E2E test data...
✅ E2E test data seeded successfully
✅ E2E database initialized successfully
🚀 Starting development server for E2E tests...
🚀 Starting server...
✅ Server started successfully
🚀 Starting client...
✅ Client started successfully
⏳ Waiting for server at http://localhost:3120...
✅ Server is ready
⏳ Waiting for application to be ready...
✅ Application is ready
🔍 Verifying test data...
✅ API health check passed
✅ /api/roles: 3 items
🔍 Handling initial profile selection...
📋 Profile selection modal detected
🎯 Starting profile selection...

📍 Attempt 1/3 to select profile...
Select trigger text: "Select your name..."
📂 Opening profile dropdown...
🔍 Trying strategy: Standard role="option"
✅ Standard role="option": Found 3 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'E2E Test User 1 (E2E Developer)',
  'E2E Test User 2 (E2E Designer)',
  'E2E Test Manager (E2E Manager)'
]
Selecting profile: "E2E Test User 1 (E2E Developer)"
Select value after click: "Select your name..."
🔄 Retrying...

📍 Attempt 2/3 to select profile...
Select trigger text: "Select your name..."
📂 Opening profile dropdown...
🔍 Trying strategy: Standard role="option"
✅ Standard role="option": Found 3 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'E2E Test User 1 (E2E Developer)',
  'E2E Test User 2 (E2E Designer)',
  'E2E Test Manager (E2E Manager)'
]
Selecting profile: "E2E Test User 1 (E2E Developer)"
Select value after click: "Select your name..."
🔄 Retrying...

📍 Attempt 3/3 to select profile...
Select trigger text: "Select your name..."
📂 Opening profile dropdown...
🔍 Trying strategy: Standard role="option"
✅ Standard role="option": Found 3 options
DOM state: 0 portals, 0 popper wrappers
Available profiles: []
Selecting profile: "undefined"
🔌 All UI attempts failed, trying API fallback...
🔌 Using API fallback for profile selection...
API fallback: Selecting E2E Test User 1
✅ Profile selected via API fallback
✅ Profile selected and saved
💾 Current auth data: { hasCurrentUser: true, hasSelectedProfile: true }
💾 Authentication state saved to /home/tony/GitHub/Capacinator/test-results/e2e-auth.json
✅ Saved state verification: Contains localStorage data
✅ E2E global setup completed successfully
