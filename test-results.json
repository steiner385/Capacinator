
> capacinator@1.0.0 test:e2e
> playwright test --reporter=json

ğŸš€ Starting E2E global setup...
ğŸ—„ï¸ Initializing E2E database...
ğŸ§ª Initializing E2E test database...
ğŸ”§ Running E2E database migrations...
Creating baseline database schema...
âœ… Baseline database schema created successfully
Fixing primary role foreign key constraint...
âœ… Fixed primary role foreign key constraint
Creating missing database views...
âœ… Created missing database views
Adding person_utilization_view and project_demands_view...
âœ… Added person_utilization_view and project_demands_view
Fixing project_demands_view with correct join conditions...
âœ… Fixed project_demands_view with correct join conditions
Fixing database views...
âœ… Fixed database views
Adding project_health_view for gaps analysis...
âœ… Added project_health_view for gaps analysis
Fixing project_health_view with correct health_status column...
âœ… Fixed project_health_view with correct health_status column
Improving project_demands_view with hour calculations...
âœ… Improved project_demands_view with hour calculations and project type info
Fixing project_demands_view missing columns...
âœ… Fixed project_demands_view with missing phase_id and renamed estimated_hours to demand_hours
Creating project_phase_dependencies table...
âœ… Created project_phase_dependencies table with constraints and indexes
ğŸ”§ Fixing missing IDs in database records...
Found 0 assignments without IDs
Found 0 availability overrides without IDs
âœ… Fixed missing IDs
ğŸŒ± Seeding E2E test data...
ğŸŒ± Seeding E2E test data...
âœ… E2E test data seeded successfully
âœ… E2E database initialized successfully
âœ… Development server already running
â³ Waiting for application to be ready...
âœ… Application is ready
ğŸ” Verifying test data...
âœ… API health check passed
âœ… /api/roles: 3 items
ğŸ” Handling initial profile selection...
ğŸ“‹ Profile selection modal detected
ğŸ¯ Starting profile selection...

ğŸ“ Attempt 1/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âœ… Standard role="option": Found 33 options
DOM state: 0 portals, 0 popper wrappers
Available profiles: []
Selecting profile: "undefined"
âŒ Attempt 1 failed: locator.click: Timeout 30000ms exceeded.
Call log:
[2m  - waiting for locator('[role="option"]:visible').first()[22m

    at selectProfile (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:458:43)
    at handleInitialProfileSelection (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:329:7)
    at globalSetup (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:67:5) {
  name: 'TimeoutError'
}
ğŸ”„ Retrying...

ğŸ“ Attempt 2/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âœ… Standard role="option": Found 33 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'E2E Test User 1 (E2E Developer)',
  'E2E Test User 2 (E2E Designer)',
  'E2E Test Manager (E2E Manager)',
  'proj-Person-1',
  'proj-Person-2',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'forms-Person-1',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'navlinks-Person-1',
  'navlinks-Person-2',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'proj-Person-1',
  'proj-Person-2',
  'forms-Person-1',
  'write-ops-Project-To-Delete-Owner',
  'data-rel-Person-1',
  'data-rel-Person-2',
  'data-rel-Person-3'
]
Selecting profile: "E2E Test User 1 (E2E Developer)"
âŒ Attempt 2 failed: locator.click: Timeout 30000ms exceeded.
Call log:
[2m  - waiting for locator('[role="option"]:visible').first()[22m

    at selectProfile (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:458:43)
    at handleInitialProfileSelection (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:329:7)
    at globalSetup (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:67:5) {
  name: 'TimeoutError'
}
ğŸ”„ Retrying...

ğŸ“ Attempt 3/3 to select profile...
Select trigger text: "Select your name..."
ğŸ“‚ Opening profile dropdown...
ğŸ” Trying strategy: Standard role="option"
âœ… Standard role="option": Found 33 options
DOM state: 0 portals, 1 popper wrappers
Available profiles: [
  'E2E Test User 1 (E2E Developer)',
  'E2E Test User 2 (E2E Designer)',
  'E2E Test Manager (E2E Manager)',
  'proj-Person-1',
  'proj-Person-2',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'forms-Person-1',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'navlinks-Person-1',
  'navlinks-Person-2',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'assign-Person-1',
  'assign-Person-2',
  'assign-Person-3',
  'person-Person-1',
  'person-Person-2',
  'person-Person-3',
  'proj-Person-1',
  'proj-Person-2',
  'forms-Person-1',
  'write-ops-Project-To-Delete-Owner',
  'data-rel-Person-1',
  'data-rel-Person-2',
  'data-rel-Person-3'
]
Selecting profile: "E2E Test User 1 (E2E Developer)"
âŒ Attempt 3 failed: locator.click: Timeout 30000ms exceeded.
Call log:
[2m  - waiting for locator('[role="option"]:visible').first()[22m

    at selectProfile (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:458:43)
    at handleInitialProfileSelection (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:329:7)
    at globalSetup (/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts:67:5) {
  name: 'TimeoutError'
}
ğŸ”Œ All UI attempts failed, trying API fallback...
ğŸ”Œ Using API fallback for profile selection...
API fallback: Selecting E2E Test User 1
âœ… Profile selected via API fallback
âœ… Profile selected and saved
ğŸ’¾ Current auth data: { hasCurrentUser: true, hasSelectedProfile: true }
ğŸ’¾ Authentication state saved to /home/tony/GitHub/Capacinator/test-results/e2e-auth.json
âœ… Saved state verification: Contains localStorage data
âœ… E2E global setup completed successfully
ğŸ§¹ Starting E2E global teardown...
ğŸ—‘ï¸ Cleaning up test data for run: e2e-1758311537311
âš ï¸ scenario assignments endpoint not available, skipping cleanup
ğŸ—„ï¸ Cleaning up E2E database...
ğŸ§¹ Cleaning up E2E database...
âœ… E2E database cleaned up
ğŸ—‘ï¸ Cleaning up authentication state...
âœ… E2E global teardown completed successfully
{
  "config": {
    "configFile": "/home/tony/GitHub/Capacinator/playwright.config.ts",
    "rootDir": "/home/tony/GitHub/Capacinator/tests/e2e",
    "forbidOnly": false,
    "fullyParallel": false,
    "globalSetup": "/home/tony/GitHub/Capacinator/tests/e2e/helpers/e2e-global-setup.ts",
    "globalTeardown": "/home/tony/GitHub/Capacinator/tests/e2e/helpers/global-teardown.ts",
    "globalTimeout": 0,
    "grep": {},
    "grepInvert": null,
    "maxFailures": 0,
    "metadata": {},
    "preserveOutput": "always",
    "reporter": [
      [
        "json"
      ]
    ],
    "reportSlowTests": {
      "max": 5,
      "threshold": 300000
    },
    "quiet": false,
    "projects": [
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "smoke",
        "name": "smoke",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "**/archived/**/*.spec.ts"
        ],
        "testMatch": [
          "/.*smoke.*\\.spec\\.ts$/"
        ],
        "timeout": 60000
      },
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "chromium",
        "name": "chromium",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "/.*smoke.*\\.spec\\.ts$/",
          "/.*slow.*\\.spec\\.ts$/"
        ],
        "testMatch": [
          "**/*.@(spec|test).?(c|m)[jt]s?(x)"
        ],
        "timeout": 60000
      },
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "firefox",
        "name": "firefox",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "**/archived/**/*.spec.ts"
        ],
        "testMatch": [
          "/.*@cross-browser.*\\.spec\\.ts$/"
        ],
        "timeout": 60000
      },
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "mobile",
        "name": "mobile",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "**/archived/**/*.spec.ts"
        ],
        "testMatch": [
          "/.*mobile.*\\.spec\\.ts$/"
        ],
        "timeout": 60000
      },
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "api",
        "name": "api",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "**/archived/**/*.spec.ts"
        ],
        "testMatch": [
          "/.*api.*\\.spec\\.ts$/"
        ],
        "timeout": 60000
      },
      {
        "outputDir": "/home/tony/GitHub/Capacinator/test-results",
        "repeatEach": 1,
        "retries": 1,
        "metadata": {},
        "id": "scenarios",
        "name": "scenarios",
        "testDir": "/home/tony/GitHub/Capacinator/tests/e2e",
        "testIgnore": [
          "**/archived/**/*.spec.ts"
        ],
        "testMatch": [
          "/.*scenario.*\\.spec\\.ts$/"
        ],
        "timeout": 120000
      }
    ],
    "shard": null,
    "updateSnapshots": "missing",
    "updateSourceMethod": "patch",
    "version": "1.55.0",
    "workers": 4,
    "webServer": null
  },
  "suites": [],
  "errors": [
    {
      "message": "SyntaxError: /home/tony/GitHub/Capacinator/tests/e2e/utilization-modals-comprehensive.spec.ts: Unexpected token (574:0)\n\n  572 |     });\n  573 |   });\n> 574 | });\n      | ^\n  575 |",
      "stack": "SyntaxError: /home/tony/GitHub/Capacinator/tests/e2e/utilization-modals-comprehensive.spec.ts: Unexpected token (574:0)\n\n  572 |     });\n  573 |   });\n> 574 | });\n      | ^\n  575 |",
      "location": {
        "file": "/home/tony/GitHub/Capacinator/tests/e2e/utilization-modals-comprehensive.spec.ts",
        "line": 574,
        "column": 0
      },
      "snippet": "\u001b[90m   at \u001b[39mutilization-modals-comprehensive.spec.ts:574\n\n  572 |     });\n  573 |   });\n> 574 | });\n  575 |"
    }
  ],
  "stats": {
    "startTime": "2025-09-19T19:52:17.263Z",
    "duration": 105671.26599999999,
    "expected": 0,
    "skipped": 0,
    "unexpected": 0,
    "flaky": 0
  }
}
